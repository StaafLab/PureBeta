[{"path":"https://staaflab.github.io/PurEst/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Iñaki Sasiain Casado. Maintainer.","code":""},{"path":"https://staaflab.github.io/PurEst/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Sasiain , Nacer DF, Aine M, Veerla S, Staaf J (?). “Tumour purity estimated bulk DNA methylation can used adjusting beta values individual samples better reflect tumor biology.” Nucleic Acid Research Genomic Bioinformatics, ?(?), ? doi:?. Staaf J, Aine M (2022). “Tumor purity adjusted beta values improve biological interpretability high-dimensional DNA methylation data.” Plos One, 17(9), 20. doi:10.1371/journal.pone.0265557.","code":"@Article{,   title = {Tumour purity estimated from bulk DNA methylation can be used for adjusting beta values of individual samples to better reflect tumor biology},   author = {Iñaki Sasiain and Deborah F. Nacer and Mattias Aine and Srinivas Veerla and Johan Staaf},   journal = {Nucleic Acid Research Genomic and Bioinformatics},   year = {?},   volume = {?},   number = {?},   pages = {?},   doi = {?}, } @Article{,   title = {Tumor purity adjusted beta values improve biological interpretability of high-dimensional DNA methylation data},   author = {Johan Staaf and Mattias Aine},   journal = {Plos One},   year = {2022},   volume = {17},   number = {9},   pages = {20},   doi = {https://doi.org/10.1371/journal.pone.0265557}, }"},{"path":"https://staaflab.github.io/PurEst/index.html","id":"how-to-install","dir":"","previous_headings":"","what":"How to install","title":"Method for calculating tumor purity and adjusting Illumina 450/850K DNA methylation beta values","text":"","code":"# Install devtools if required if(!requireNamespace(\"devtools\", quietly = TRUE)) {   install.packages(\"devtools\", quietly = TRUE) }  # Load the library library(devtools)  # Install and load PurEst install_github(\"StaafLab/PurEst/PurEst\")"},{"path":"https://staaflab.github.io/PurEst/index.html","id":"framework","dir":"","previous_headings":"","what":"Framework","title":"Method for calculating tumor purity and adjusting Illumina 450/850K DNA methylation beta values","text":"PurEst package divided four main functions: Correction beta values cohort known sample purities: function beta_correction_for_cohorts() performs beta value adjustment based tumour sample compusition based original Staaf & Aine beta correction approch, correcting betas cohort samples known sample purities. information approach can found original publication: Staaf & Aine, PLosOne, 2022. Creation reference data cohort: reference_regressions_generator() function, reference linear regressions calculated based DNA methylation beta values tumor purity estimates cohort. regression represents sample population shown figure . Scripts used module: ref_regression_calculator.r (main), new_function_correctBetas.r. Estimation tumor purities individual samples: PurEst() function, CpGs filtered based beta variance CpG processed individually per sample shown figure . Scripts used module: purity_estimator.r (main), predicting_purity.r, purity_coverage.r.  Adjustment beta values per CpG per sample: reference_based_beta_correction() function, beta values adjusted tumor cells inferred normal cells using reference regressions estimated purities. can carried refitting regressions include new data points estimated purities using original reference regressions. Scripts used module: final_beta_correction.r (main), new_function_correctBetas.r.","code":""},{"path":"https://staaflab.github.io/PurEst/reference/PurEst.html","id":null,"dir":"Reference","previous_headings":"","what":"PurEst — PurEst","title":"PurEst — PurEst","text":"PurEst() function estimates tumour sample purity based DNA methylation beta values reference linear models reflect correlation tumour purity beta values analysed CpG.function can applied single multiple samples run allows multi-core execution.","code":""},{"path":"https://staaflab.github.io/PurEst/reference/PurEst.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"PurEst — PurEst","text":"","code":"PurEst(   reference_regressions,   beta_values,   alpha = 0.7,   slope_threshold = 0.25,   variance_threshold = 0.05,   proportion_to_interval = 0.96,   cores = 1 )"},{"path":"https://staaflab.github.io/PurEst/reference/PurEst.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"PurEst — PurEst","text":"reference_regressions List objects containing parameters reference regressions determined using reference_regression_generator() function (short extended versions valid). input list must least include regs$reg.slopes, regs$reg.intercepts, regs$reg.RSE regs$cpg.variance fields. beta_values matrix CpGs rows analysed samples (individual sample) columns uncorrected beta values CpGs samples intended corrected. values must numeric, rows must names CpG ID, columns sample IDs. example reequired format available example_betas_to_correct matrix. alpha Default = 0.7. alpha value used determine thewidth prediction intervals CpG sample determined reference regressions. usage excessively wide narrow interval can increase prediction error. slope_threshold Default = 0.25. Minimum slope allowed per regression taken consideration sample purity estimation. regression threshold can increase prediction error, therefore considered uninformative ignored variance_threshold Default = 0.05. CpG beta value variance cutoff filter reference data. CpGs variable enough PurEst can obtain information estimation. CpGs non-informative can increase execution time prediction error. proportion_to_interval Default = 0.96. Percentage maximum 1 - purity coverage detected include estimated 1-Purity interval. lower value generate wide intervals, higher one narrow ranges. cores Default = 1. Number cores used run function parallel.","code":""},{"path":"https://staaflab.github.io/PurEst/reference/PurEst.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"PurEst — PurEst","text":"List containing data frame predicted 1 - Purity values (output$`Estimated_1mPurities`). contains identified estimates (exceptional cases different 1) estimated 1-Purity values intervals predicted per sample. one estimates obtained, one independent line per estimate created data frame. List CpGs used purity prediction sample filtering steps (output$`Used_CpGs`).","code":""},{"path":"https://staaflab.github.io/PurEst/reference/PurEst.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"PurEst — PurEst","text":"","code":"# Using the default parameters PurEst(reference_regressions = output_from_reference_regression_generator,        beta_values = example_betas_to_correct)  # Specifying new parameters PurEst(reference_regressions = output_from_reference_regression_generator,        beta_values = example_betas_to_correct,        alpha = 0.75,        slope_threshold = 0.2,        variance_threshold = 0.06,        proportion_to_interval = 0.93,        cores = 5)"},{"path":"https://staaflab.github.io/PurEst/reference/beta_correction_for_cohorts.html","id":null,"dir":"Reference","previous_headings":"","what":"beta_correction_for_cohorts — beta_correction_for_cohorts","title":"beta_correction_for_cohorts — beta_correction_for_cohorts","text":"functions applies original Staaf & Aine DNA methylation beta value correction strategy adjust effect sample purities cohorts known sample purities CpG beta values (Staaf & Aine, Plos One, 2022). function allows mult-core execution.","code":""},{"path":"https://staaflab.github.io/PurEst/reference/beta_correction_for_cohorts.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"beta_correction_for_cohorts — beta_correction_for_cohorts","text":"","code":"beta_correction_for_cohorts(   beta_values,   tumour_purities,   set_seed = FALSE,   seed_num = 2000,   cores = 1 )"},{"path":"https://staaflab.github.io/PurEst/reference/beta_correction_for_cohorts.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"beta_correction_for_cohorts — beta_correction_for_cohorts","text":"beta_values matrix CpGs rows tumour samples columns uncorrected beta values CpGs samples intended corrected. values must numeric, rows must named CpG ID, columns sample IDs. example required format available example_betas_reference matrix. tumour_purities Named vector containing sample purity values samples whose DNA methylation beta values intended corrected. vector must named sample ID, must match sample IDs matrix containing beta values. example required format available example_purities_reference vector. set_seed Default = FALSE. seed FlexMix package detect different CpG methylation patterns can used setting argument TRUE. seed_num Default = 2000. seed used set_seed = TRUE can specified . cores Default = 1. Number cores used run function parallel.","code":""},{"path":"https://staaflab.github.io/PurEst/reference/beta_correction_for_cohorts.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"beta_correction_for_cohorts — beta_correction_for_cohorts","text":"List containing original uncorrected beta values (output$betas.original), corrected tumour beta values (output$betas.tumour) corrected microenvironment beta values (output$betas.microenvironment).","code":""},{"path":"https://staaflab.github.io/PurEst/reference/beta_correction_for_cohorts.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"beta_correction_for_cohorts — beta_correction_for_cohorts","text":"","code":"# Using the default parameters beta_correction_for_cohorts (beta_values = example_betas_reference,                              tumour_purities = example_purities_reference)  # Specifying new parameters beta_correction_for_cohorts (beta_values = example_betas_reference,                              tumour_purities = example_purities_reference,                              set_seed = TRUE,                              seed_num = 1,                              cores = 5)"},{"path":"https://staaflab.github.io/PurEst/reference/example_betas_reference.html","id":null,"dir":"Reference","previous_headings":"","what":"example_betas_reference — example_betas_reference","title":"example_betas_reference — example_betas_reference","text":"marix containing uncorrected beta values 5.000 variable CpGs TCGA-BRCA dataset. matrix intended used example reference data PurEst package.","code":""},{"path":"https://staaflab.github.io/PurEst/reference/example_betas_reference.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"example_betas_reference — example_betas_reference","text":"","code":"example_betas_reference"},{"path":"https://staaflab.github.io/PurEst/reference/example_betas_reference.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"example_betas_reference — example_betas_reference","text":"matrix 5000 rows (CpGs) 126 columns (samples).","code":""},{"path":"https://staaflab.github.io/PurEst/reference/example_betas_reference.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"example_betas_reference — example_betas_reference","text":"<https://github.com/StaafLab/PurEst>","code":""},{"path":"https://staaflab.github.io/PurEst/reference/example_betas_to_correct.html","id":null,"dir":"Reference","previous_headings":"","what":"example_betas_to_correct — example_betas_to_correct","title":"example_betas_to_correct — example_betas_to_correct","text":"matrix containing uncorrected beta values 5.000 variable CpGs TCGA-BRCA dataset. intended used example file run beta correction based reference files.","code":""},{"path":"https://staaflab.github.io/PurEst/reference/example_betas_to_correct.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"example_betas_to_correct — example_betas_to_correct","text":"","code":"example_betas_to_correct"},{"path":"https://staaflab.github.io/PurEst/reference/example_betas_to_correct.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"example_betas_to_correct — example_betas_to_correct","text":"matrix 5000 rows (CpGs) 504 columns (samples).","code":""},{"path":"https://staaflab.github.io/PurEst/reference/example_betas_to_correct.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"example_betas_to_correct — example_betas_to_correct","text":"<https://github.com/StaafLab/PurEst>","code":""},{"path":"https://staaflab.github.io/PurEst/reference/example_purities_reference.html","id":null,"dir":"Reference","previous_headings":"","what":"example_purities_reference — example_purities_reference","title":"example_purities_reference — example_purities_reference","text":"named vector purity values samples included reference beta value matrix. intended used reference correct betas estimate purity based reference regressions.","code":""},{"path":"https://staaflab.github.io/PurEst/reference/example_purities_reference.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"example_purities_reference — example_purities_reference","text":"","code":"example_purities_reference"},{"path":"https://staaflab.github.io/PurEst/reference/example_purities_reference.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"example_purities_reference — example_purities_reference","text":"named vector 126 elements.","code":""},{"path":"https://staaflab.github.io/PurEst/reference/example_purities_reference.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"example_purities_reference — example_purities_reference","text":"<https://github.com/StaafLab/PurEst>","code":""},{"path":"https://staaflab.github.io/PurEst/reference/reference_based_beta_correction.html","id":null,"dir":"Reference","previous_headings":"","what":"Reference based beta correction — reference_based_beta_correction","title":"Reference based beta correction — reference_based_beta_correction","text":"script corrects beta values samples whose purity estimated  based reference cohort following two approaches, refitting reference  regressions include , reference data points new ones  (betas correct + estimated purity) without refitting reference  regressions, using directly original reference linear models  correction. function allows multi-core execution.","code":""},{"path":"https://staaflab.github.io/PurEst/reference/reference_based_beta_correction.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Reference based beta correction — reference_based_beta_correction","text":"","code":"reference_based_beta_correction(   betas_to_correct,   purities_samples_to_correct,   only_certain_CpGs = FALSE,   CpGs_to_correct_vector,   refitting,   reference_regressions,   reference_betas,   reference_purities,   use_seed = TRUE,   seed_num = 2000,   cores = 1 )"},{"path":"https://staaflab.github.io/PurEst/reference/reference_based_beta_correction.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Reference based beta correction — reference_based_beta_correction","text":"betas_to_correct matrix CpGs rows analysed samples (individual sample) columns uncorrected beta values CpGs samples intended corrected. values must numeric, rows must named CpG ID, columns sample IDs. example required format available example_betas_to_correct matrix. purities_samples_to_correct output PurEst tumour sample purity estimation function original format entered . only_certain_CpGs Default = FALSE. beta correction applied certain CpGs ones included matrix provided betas_to_correct argument argument set TRUE. refitting Default = FALSE. argument set TRUE user wants refit reference regression also take account betas PurEst estimated sample purity values additional data points. advisable non-fully representative reference dataset significant number samples whose purity estimated using PurEst. Else, reference regressions directly used beta correction. reference_regressions output reference regression generator entered refitting argument set TRUE. Else, argument ignored. argument accepts , normal extended versions reference_regression_generator function's output. reference_betas matrix CpGs rows analysed samples (individual sample) columns uncorrected beta values CpGs samples intended used reference data entered refitting argument set TRUE. values must numeric, rows must names CpG ID, columns sample IDs. example required format available example_betas_reference matrix. T reference_purities Named vector containing sample purity values samples whose DNA methylation beta values intended used reference data entered refitting argument set TRUE. vector must named sample ID, must match sample IDs matrix containing beta values. example required format available example_purities_reference vector use_seed Default = FALSE. seed FlexMix package detect different CpG methylation patterns can used setting argument TRUE. argument used refitting argument set TRUE. seed_num Default = 2000. seed used set_seed = TRUE can specified . cores Default = 1. Number cores used run function parallel. CpGs_to_correct_vector. vector CpG IDs corrected only_certain_CpGs = TRUE specified.","code":""},{"path":"https://staaflab.github.io/PurEst/reference/reference_based_beta_correction.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Reference based beta correction — reference_based_beta_correction","text":"List corrected betas tumour (output$`Corrected_tumor`) microenvironment (output$`Corrected_microenvironment`) refitting = FALSE. refitting = TRUE selected corrected betas tumour microenvironment (output$`Corrected_betas`) available addition parameters refitted new regressions (output$`Regression_parameters`).","code":""},{"path":"https://staaflab.github.io/PurEst/reference/reference_based_beta_correction.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Reference based beta correction — reference_based_beta_correction","text":"","code":"# Using the non-refitting approach for all the CpGs reference_based_beta_correction(betas_to_correct = example_betas_to_correct,                                 purities_samples_to_correct = PurEst_output,                                 only_certain_CpGs = FALSE,                                 refitting = FALSE,                                 reference_regressions = reference_regression_generator_output,                                 cores = 5)  # Using the non-refitting approach for certain CpGs reference_based_beta_correction(betas_to_correct = example_betas_to_correct,                                 purities_samples_to_correct = PurEst_output,                                 only_certain_CpGs = TRUE,                                 CpGs_to_correct_vector = c(\"cg09248054\", \"cg08231710\"),                                 refitting = FALSE,                                 refernce_regressions = reference_regression_generator_output,                                 cores = 5)   # Using the refitting approach reference_based_beta_correction(betas_to_correct = example_betas_to_correct,                                 purities_samples_to_correct = PurEst_output,                                 only_certain_CpGs = FALSE,                                 refitting = TRUE,                                 reference_betas = example_betas_reference,                                 reference_purities = example_purities_reference,                                 set_seed = TRUE,                                 seed_num = 1,                                 cores = 5)"},{"path":"https://staaflab.github.io/PurEst/reference/reference_regression_generator.html","id":null,"dir":"Reference","previous_headings":"","what":"reference_regression_generator — reference_regression_generator","title":"reference_regression_generator — reference_regression_generator","text":"function generates reference regressions' parameters variance used reference CpGs required used subsequent steps PurEst workflow based Staaf & Aine methylation beta value correction strategy. function allows multi-core execution.","code":""},{"path":"https://staaflab.github.io/PurEst/reference/reference_regression_generator.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"reference_regression_generator — reference_regression_generator","text":"","code":"reference_regression_generator(   beta_values,   tumour_purities,   set_seed = FALSE,   seed_num = 2000,   cores = 1,   regression_details = FALSE )"},{"path":"https://staaflab.github.io/PurEst/reference/reference_regression_generator.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"reference_regression_generator — reference_regression_generator","text":"beta_values matrix CpGs rows analysed samples  columns uncorrected beta values CpGs samples intended used build reference regressions. values must numeric, rows must names CpG ID, columns sample IDs. example required format available example_betas_reference matrix. tumour_purities Named vector containing purity values samples whose DNA methylation beta values intended used build reference regressions. vector must named sample ID, must match sample IDs matrix containing beta values. example required format available example_purities_reference vector set_seed Default = FALSE. seed FlexMix package detect different CpG methylation patterns can used setting argument TRUE. seed_num Default = 2000. seed used set_seed = TRUE can specified . cores Default = 1. Number cores used run function parallel. regression_details Default = FALSE. user can set argument TRUE obtain extended version output reference list containing original beta values, corrected tumour microenvironment betas applying Staaf & Aine beta correction whole cohorts reference data, methylation pattern population assigned sample used buld reference regressions per CpG.","code":""},{"path":"https://staaflab.github.io/PurEst/reference/reference_regression_generator.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"reference_regression_generator — reference_regression_generator","text":"list parameters computed reference regressions. list contains variance betas CpGs used build regressions (output$cpg.variance), slopes, intercepts residual standard error degrees freedom regression calculated per CpG (output$reg.slopes, output$reg.intercepts, output$reg.RSE output$df). extended output list required also include original uncorrected beta values (output$betas.original), corrected tumour beta values (output$betas.tumour), corrected microenvironment beta values (output$betas.microenvironment) methylation pattern population assigned sample used buld reference regressions per CpG (output$cpg.populations).","code":""},{"path":"https://staaflab.github.io/PurEst/reference/reference_regression_generator.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"reference_regression_generator — reference_regression_generator","text":"","code":"# Using the default parameters reference_regression_generator(beta_values = example_betas_reference,                              tumour_purities = example_purities_reference)  # Specifying new parameters reference_regression_generator(beta_values = example_betas_reference,                                tumour_purities = example_purities_reference,                                set_seed = TRUE,                                seed_num = 1,                                cores = 5,                                regressuion_details = TRUE)"}]
