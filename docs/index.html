<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Method for calculating tumor purity and adjusting Illumina 450/850K DNA methylation beta values • PureBeta</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Method for calculating tumor purity and adjusting Illumina 450/850K DNA methylation beta values">
<meta name="description" content="This package allows for the adjustment of DNA methylation beta values based on sample purity, to account for the effect of tumor composition in experimentally determined beta values. Additionally, it allows for the estimation of sample purity from unadjusted beta values using reference data.">
<meta property="og:description" content="This package allows for the adjustment of DNA methylation beta values based on sample purity, to account for the effect of tumor composition in experimentally determined beta values. Additionally, it allows for the estimation of sample purity from unadjusted beta values using reference data.">
<meta property="og:image" content="https://staaflab.github.io/PureBeta/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">PureBeta</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><p><font size="12"><strong>PureBeta</strong> </font> <a href="https://staaflab.github.io/PureBeta/"><img src="reference/figures/logo.png" align="right" height="278" alt="PureBeta website"></a></p>
<p>Method for calculating tumor purity and adjusting Illumina 450/850K DNA methylation beta values. This work has been described in the article “<strong>Tumor purity estimated from bulk DNA methylation can be used for adjusting beta values of individual samples to better reflect tumor biology</strong>” published by <a href="LINK">Sasiain, Nacer et al. in <em>JOURNAL</em></a>.</p>
<div class="section level2">
  <h2 id="how-to-install">How to install<a class="anchor" aria-label="anchor" href="#how-to-install"></a></h2>
  <div class="sourceCode" id="cb1">
    <pre class="downlit sourceCode r"><code class="sourceCode R"><span class="co"># Install devtools if you don't have it yet</span>
<span class="fu">install.packages</span>(<span class="st">"devtools"</span>)
<span class="co"># Load the library</span>
<span class="kw">library</span>(<span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span>)
<span class="co"># Install and load PureBeta</span>
<span class="fu">install_github</span>(<span class="st">"StaafLab/PureBeta"</span>)
<span class="kw">library</span>(<span class="va">PureBeta</span>)
</code></pre>
  </div>
</div>



<!-- Insert the textbox here -->
<div style="border: 1px solid #ccc; padding: 10px; background-color: #f9f9f9; margin-top: 15px;">
  <strong>NOTE:</strong> Due to the included reference data, the installation of the package may require more than 30 seconds. In case of reaching the installation timeout when installing the package, consider changing the default timeout as follows:
  <pre><code class="sourceCode R"><span><span class="co"># Updating the default timeout to 1000</span></span>
  <span><span class="kw">options</span><span class="op">(</span><span class="st">timeout = 1000</span><span class="op">)</span></span></code></pre>
</div>


<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p>Solid tumors are complex mixtures of tumor cells and non-malignant cells such as leukocytes and non-immune stromal cells. Consequently, DNA methylation data estimated from tumor samples are a mixture of signals obtained from the malignant and non-malignant sections of the tumor. Here we present PureBeta, an R package that allows for the adjustment of DNA methylation beta values to account for the effect of sample composition. This package allows for the correction of complete cohorts of samples with known sample purities and CpG beta values, and for the estimation of sample purity and subsequent beta correction using reference data and uncorrected beta values of data sets (or single samples) without known sample purities.</p>
</div>
<div class="section level2">
<h2 id="framework">Framework<a class="anchor" aria-label="anchor" href="#framework"></a>
</h2>
<p>The PureBeta package is divided into four main functions described below. For more information such as parameters, click on "Reference" at the top of this page and then on the function name.</p>
<ol style="list-style-type: decimal">
<li><p><em>Correction of beta values from a cohort with known sample purities</em>: The function <strong><em>beta_correction_for_cohorts()</em></strong> performs beta value adjustment for tumor sample composition based on the original Staaf &amp; Aine beta correction approch, correcting betas from a cohort of samples with known sample purities. More information about this approach can be found in the original publication: <a href="https://doi.org/10.1371/journal.pone.0265557" class="external-link">Staaf &amp; Aine, PLosOne, 2022</a>.</p></li>
<li><p><em>Creation of reference data from a cohort</em>: in the <strong><em>reference_regressions_generator()</em></strong> function, reference linear regressions are calculated based on DNA methylation beta values and tumor purity estimates of a cohort. Each regression represents a sample population as shown in the figure below.</p></li>
</ol>
<img src="./reference/figures/module1.png" width="350"><ol start="3" style="list-style-type: decimal">
<li>
<em>Estimation of tumor purities for individual samples</em>: in the <strong><em>purity_estimation()</em></strong> function, CpGs are first filtered based on beta variance removing those considered to be non-informatoive. Each CpG is then processed individually obtaining a sample purity interval. Finally, all the obtained intervals per sample are integrated generating a purity estimate for the sample.</li>
</ol>
<p><img src="./reference/figures/module2.png"></p>
<ol start="4" style="list-style-type: decimal">
<li>
<em>Adjustment of beta values per CpG and sample</em>: in the <strong><em>reference_based_beta_correction()</em></strong> function, beta values are adjusted for sample composition using reference regressions and estimated purities. This can be peformed following two approaches: refitting the regressions to include the new data points (betas to correct + estimated purities) or using the original reference regressions. Unlike <strong>beta_correction_for_cohorts()</strong>, this function does not require the usage of a full cohort of samples, as it is applicable to a single sample and single CpG. DNA methylation beta values and estimated purities for TCGA BRCA, LUAD, and LUSC samples are available on <a href="https://doi.org/10.6084/m9.figshare.26272864" class="external-link">FigShare</a> for the refitting approach.</li>
</ol>
<p><img src="./reference/figures/module3.png"></p>
</div>
<div class="section level2">
<h2 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h2>
<p>This package includes precomputed reference regressions that model the correlation between DNA methylation beta values and sample purities obtained from <strong>The Cancer Genome Atlas</strong> for three different cancer types:</p>
<ul>
<li>Breast Cancer (BRCA)</li>
<li>Lung Adenocarcinoma (LUAD)</li>
<li>Lung Squamous Cell Carcinoma (LUSC)</li>
</ul>
<p>Due to size limitations these files do not include all the parameters needed to run the bootstrapping based purity estimation. Those files ara available in <a href="https://figshare.com/projects/Reference_regressions_for_PureBeta/222058" class="external-link">FigShare</a></p>
<p>Additionally, it includes small example datasets (purities and original beta values of a reference set with less samples, and original betas from a larger cohort) obtained from the 5000 most variable CpGs in the TCGA BRCA data set to test the execution of the package’s functions.</p>
<div class="section level3">
<h3 id="license">License<a class="anchor" aria-label="anchor" href="#license"></a>
</h3>
<p>The PureBeta R package is under the GPL-3.0 license. A copy of this license is included with the package.</p>
</div>
</div>

  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing PureBeta</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Iñaki Sasiain Casado <br><small class="roles"> Maintainer </small>  </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Iñaki Sasiain Casado.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
