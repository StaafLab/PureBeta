<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Purity Estimation — purity_estimation • PureBeta</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Purity Estimation — purity_estimation"><meta name="description" content="The purity_estimation() function estimates tumour sample purity based on DNA methylation
beta values and reference linear models that reflect the correlation between
tumour purity and beta values in each analysed CpG. This function can be
applied to both single and multiple samples in each run and allows multi-core
execution."><meta property="og:description" content="The purity_estimation() function estimates tumour sample purity based on DNA methylation
beta values and reference linear models that reflect the correlation between
tumour purity and beta values in each analysed CpG. This function can be
applied to both single and multiple samples in each run and allows multi-core
execution."><meta property="og:image" content="https://staaflab.github.io/PureBeta/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">PureBeta</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Purity Estimation</h1>

      <div class="d-none name"><code>purity_estimation.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The purity_estimation() function estimates tumour sample purity based on DNA methylation
beta values and reference linear models that reflect the correlation between
tumour purity and beta values in each analysed CpG. This function can be
applied to both single and multiple samples in each run and allows multi-core
execution.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">purity_estimation</span><span class="op">(</span></span>
<span>  <span class="va">reference_regressions</span>,</span>
<span>  <span class="va">beta_values</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>  slope_threshold <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  variance_threshold <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  proportion_to_interval <span class="op">=</span> <span class="fl">0.96</span>,</span>
<span>  cores <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  assume_t_distribution <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  Boots_N <span class="op">=</span> <span class="cn">500</span>,</span>
<span>  extended_output <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-reference-regressions">reference_regressions<a class="anchor" aria-label="anchor" href="#arg-reference-regressions"></a></dt>
<dd><p>List object containing the parameters of the
reference regressions determined using the reference_regression_generator()
function (both short and extended versions are valid). The input must
at least include the list containing a named vector with the variance of
the betas of CpGs used to build the regressions (input$cpg.variance), the slopes,
intercepts residual standard error and degrees of freedom of the regression
calculated per CpG (input$reg.slopes, input$reg.intercepts, input$reg.RSE
and input$df as matrices). If the prediction intervals for each regression
are intended to be calculated through bootstrapping instead of assuming t
distribution the extended version of the regressions is required.</p></dd>


<dt id="arg-beta-values">beta_values<a class="anchor" aria-label="anchor" href="#arg-beta-values"></a></dt>
<dd><p>A matrix with CpGs as rows and analysed samples (or an
individual sample) as columns with the uncorrected beta values from the CpGs
of the samples whose purities are intended to be estimated. The values must
be numeric, the rows must be names with the CpG ID, and the columns with the
sample IDs. An example of the required format is available in the
example_betas_to_correct matrix.</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>Default = 0.7. The alpha value used to determine the width of
the prediction intervals for each CpG and sample determined from the
reference regressions. The usage of a excessively wide or narrow interval can
increase the prediction error.</p></dd>


<dt id="arg-slope-threshold">slope_threshold<a class="anchor" aria-label="anchor" href="#arg-slope-threshold"></a></dt>
<dd><p>Default = 0.2. Minimum slope allowed per regression
for them to be taken into consideration in the sample purity estimation. The
inclusion of regressions below the threshold can increase the prediction error,
and therefore will be considered uninformative and ignored.</p></dd>


<dt id="arg-variance-threshold">variance_threshold<a class="anchor" aria-label="anchor" href="#arg-variance-threshold"></a></dt>
<dd><p>Default = 0.05. CpG beta value variance cutoff to
filter reference data. If the CpGs are not variable enough PureBeta cannot
obtain information for the estimation. These CpGs are non-informative and can
increase the execution time and the prediction error.</p></dd>


<dt id="arg-proportion-to-interval">proportion_to_interval<a class="anchor" aria-label="anchor" href="#arg-proportion-to-interval"></a></dt>
<dd><p>Default = 0.96. Percentage of the maximum 1 -
purity coverage detected to include in the estimated the 1-Purity interval.
A lower value will generate wider intervals, and a higher one narrower ranges.</p></dd>


<dt id="arg-cores">cores<a class="anchor" aria-label="anchor" href="#arg-cores"></a></dt>
<dd><p>Default = 1. Number of cores to be used to run the function in
parallel.</p></dd>


<dt id="arg-assume-t-distribution">assume_t_distribution<a class="anchor" aria-label="anchor" href="#arg-assume-t-distribution"></a></dt>
<dd><p>Default = TRUE. Set this argument to FALSE if the user
does not want to use the default t statistic to calculate prediction intervals from each of the
reference regression. In this case the interval will be determined through bootstrapping,
a non-parametric strategy that may significantly increase the execution time (The purity estimation
of the example dataset provided in the package using reference regressions built from the example reference
data also provided in the package is 215 times slower). The bootstrapping and t distribution based approaches
have shown almost identical results in the analysed data (TCGA-BRCA, TCGA-LUAD, TCGA-LUSC and other external validation datasets) 
using the default parameters as shown in the image below. The bootstrapping based approach may also generate excessive RAM usage
errors when parallelized on a high number of cores.</p></dd>

<img src="figures/t_boot.png" alt="Comparison of the purity estimates through bootstrapping and t-dist based approaches."> 


<dt id="arg-extended-output">extended_output<a class="anchor" aria-label="anchor" href="#arg-extended-output"></a></dt>
<dd><p>Default = FALSE. Set this argument to TRUE if the user
wants to obtain the CpGs used (informative for the estimation) for the purity
estimation of each analysed sample in the output list.</p></dd>


<dt id="arg-boost-n">Boost_N<a class="anchor" aria-label="anchor" href="#arg-boost-n"></a></dt>
<dd><p>The number of times the that the values will be bootstrapped to generate
the prediction interval should be entered here if assume_t_distribution = FALSE. While an
excessively low number will generate an unreliable output, choosing an excessively high value
will significantly decrease the function's execution speed.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>extended_output List containing a data frame with the predicted 1 - Purity values
(output$`Estimated_1mPurities`). It contains the identified estimates (in very
exceptional cases it could be different to 1) the estimated 1-Purity values
and intervals predicted per each sample. If more than one estimates are
obtained, one independent line per estimate will be created in the data frame.
A list with the CpGs used for the purity prediction of each sample after the
filtering steps is also included in the output list (output$`Used_CpGs`) if
the extended_output = TRUE option is selected.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span></span>
<span><span class="co"># Using the default parameters</span></span>
<span><span class="fu">purity_estimation</span><span class="op">(</span>reference_regressions <span class="op">=</span> <span class="va">output_from_reference_regression_generator</span>,</span>
<span>                  beta_values <span class="op">=</span> <span class="va">example_betas_to_correct</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Specifying new parameters</span></span>
<span><span class="fu">purity_estimation</span><span class="op">(</span>reference_regressions <span class="op">=</span> <span class="va">output_from_reference_regression_generator</span>,</span>
<span>                  beta_values <span class="op">=</span> <span class="va">example_betas_to_correct</span>,</span>
<span>                  alpha <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span>                  slope_threshold <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>                  variance_threshold <span class="op">=</span> <span class="fl">0.06</span>,</span>
<span>                  proportion_to_interval <span class="op">=</span> <span class="fl">0.93</span>,</span>
<span>                  cores <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                  extended_output <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Using bootstrapping</span></span>
<span><span class="fu">purity_estimation</span><span class="op">(</span>reference_regressions <span class="op">=</span> <span class="va">output_from_reference_regression_generator</span>,</span>
<span>                  beta_values <span class="op">=</span> <span class="va">example_betas_to_correct</span>,</span>
<span>                  cores <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                  extended_output <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                  assume_t_distribution <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                  Boots_N <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span></span></code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Iñaki Sasiain Casado.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

