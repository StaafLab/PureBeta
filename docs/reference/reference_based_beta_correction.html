<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Reference based beta correction — reference_based_beta_correction • PureBeta</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Reference based beta correction — reference_based_beta_correction"><meta name="description" content="This function adjusts CpG beta values for tumor cells and inferred
normal cells using reference regressions and estimated purities. This can
be carried out refitting the regressions to include the new data points
(betas + estimated purities) or using the original reference regressions. Unlike
beta_correction_for_cohorts(), this function does not require the usage
of a full cohort of samples, as it is single sample and single CpG applicable.
This function allows multi-core execution."><meta property="og:description" content="This function adjusts CpG beta values for tumor cells and inferred
normal cells using reference regressions and estimated purities. This can
be carried out refitting the regressions to include the new data points
(betas + estimated purities) or using the original reference regressions. Unlike
beta_correction_for_cohorts(), this function does not require the usage
of a full cohort of samples, as it is single sample and single CpG applicable.
This function allows multi-core execution."><meta property="og:image" content="https://staaflab.github.io/PureBeta/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">PureBeta</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Reference based beta correction</h1>

      <div class="d-none name"><code>reference_based_beta_correction.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function adjusts CpG beta values for tumor cells and inferred
normal cells using reference regressions and estimated purities. This can
be carried out refitting the regressions to include the new data points
(betas + estimated purities) or using the original reference regressions. Unlike
beta_correction_for_cohorts(), this function does not require the usage
of a full cohort of samples, as it is single sample and single CpG applicable.
This function allows multi-core execution.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">reference_based_beta_correction</span><span class="op">(</span></span>
<span>  <span class="va">betas_to_correct</span>,</span>
<span>  <span class="va">purities_samples_to_correct</span>,</span>
<span>  purities_purebeta_format <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  only_certain_CpGs <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">CpGs_to_correct_vector</span>,</span>
<span>  <span class="va">refitting</span>,</span>
<span>  <span class="va">reference_regressions</span>,</span>
<span>  <span class="va">reference_betas</span>,</span>
<span>  <span class="va">reference_purities</span>,</span>
<span>  use_seed <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  seed_num <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>  cores <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-betas-to-correct">betas_to_correct<a class="anchor" aria-label="anchor" href="#arg-betas-to-correct"></a></dt>
<dd><p>A matrix with CpGs as rows and analysed samples (or an
individual sample) as columns with the uncorrected beta values from the CpGs
of the samples that are intended to be corrected. The values must be numeric,
the rows must be named with the CpG ID, and the columns with the sample IDs.
An example of the required format is available in the example_betas_to_correct
matrix.</p></dd>


<dt id="arg-purities-samples-to-correct">purities_samples_to_correct<a class="anchor" aria-label="anchor" href="#arg-purities-samples-to-correct"></a></dt>
<dd><p>The output of the purity_estimation
function in the original format should be entered here. If the user intends
to use any alternative format a dataframe with sample IDs in the first column
and sample purity could be eneterd here after setting the purities_purebeta_format
argument to FALSE (IMPORTANT! The user MUST enter sample purity values, not 1-Purity
values).</p></dd>


<dt id="arg-purities-purebeta-format">purities_purebeta_format<a class="anchor" aria-label="anchor" href="#arg-purities-purebeta-format"></a></dt>
<dd><p>Default = TRUE. If the user wanted to use a
different input format for sample purity (see purities_samples_to_correct
for the format especifications) this argument should be set to FALSE.</p></dd>


<dt id="arg-only-certain-cpgs">only_certain_CpGs<a class="anchor" aria-label="anchor" href="#arg-only-certain-cpgs"></a></dt>
<dd><p>Default = FALSE. If the beta correction has to be
applied only to certain CpGs and not to all the ones included in the matrix
provided as the betas_to_correct argument this argument should be set to
TRUE.</p></dd>


<dt id="arg-refitting">refitting<a class="anchor" aria-label="anchor" href="#arg-refitting"></a></dt>
<dd><p>Default = FALSE. This argument should be set to TRUE if the
user wants to refit the reference regression to also take into account the
betas and PureBeta estimated sample purity values as additional data points.
This could be advisable when having a non-fully representative reference
dataset and a significant number of samples whose purity has been estimated
using PureBeta. Else, the reference regressions will be directly used for the
beta correction.</p></dd>


<dt id="arg-reference-regressions">reference_regressions<a class="anchor" aria-label="anchor" href="#arg-reference-regressions"></a></dt>
<dd><p>The output of the reference regression generator
should be entered here if the refitting argument has NOT been set to TRUE.
Else, this argument should be ignored (both short and extended versions are
valid). The input list must at least include the list contains the a named
vector with the variance of the betas of CpGs used to build the regressions
(input$cpg.variance), the slopes, intercepts residual standard error and
degrees of freedom of the regression calculated per CpG (input$reg.slopes,
input$reg.intercepts, input$reg.RSE and input$df as matrices).</p></dd>


<dt id="arg-reference-betas">reference_betas<a class="anchor" aria-label="anchor" href="#arg-reference-betas"></a></dt>
<dd><p>A matrix with CpGs as rows and analysed samples (or an
individual sample) as columns with the uncorrected beta values from the CpGs
of the samples that are intended to be used to as reference data should be
entered here if the refitting argument has been set to TRUE. The values must
be numeric, the rows must be names with the CpG ID, and the columns with the
sample IDs. An example of the required format is available in the
example_betas_reference matrix.</p></dd>


<dt id="arg-reference-purities">reference_purities<a class="anchor" aria-label="anchor" href="#arg-reference-purities"></a></dt>
<dd><p>Named vector containing the sample purity values of
of the samples whose DNA methylation beta values are intended to be used as
reference data should been entered here if the refitting argument has been set
to TRUE. The vector must be named with the sample ID, which must match with
the sample IDs from the matrix containing the beta values. An example of the
required format is available in the example_purities_reference vector.</p></dd>


<dt id="arg-use-seed">use_seed<a class="anchor" aria-label="anchor" href="#arg-use-seed"></a></dt>
<dd><p>Default = FALSE. A seed for the FlexMix package to detect
the different CpG methylation patterns can be used by setting this argument
to TRUE. This argument will only be used if the refitting argument has been
set to TRUE.</p></dd>


<dt id="arg-seed-num">seed_num<a class="anchor" aria-label="anchor" href="#arg-seed-num"></a></dt>
<dd><p>Default = 2000. The seed to be used when set_seed = TRUE can
be specified here.</p></dd>


<dt id="arg-cores">cores<a class="anchor" aria-label="anchor" href="#arg-cores"></a></dt>
<dd><p>Default = 1. Number of cores to be used to run the function in
parallel.</p></dd>


<dt id="arg-cpgs-to-correct-vector-">CpGs_to_correct_vector.<a class="anchor" aria-label="anchor" href="#arg-cpgs-to-correct-vector-"></a></dt>
<dd><p>A vector of the CpG IDs to be corrected when
only_certain_CpGs = TRUE has been specified.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>List with the corrected betas for the tumour (output$`Corrected_tumor`)
and microenvironment (output$`Corrected_microenvironment`) when refitting =
FALSE. If refitting = TRUE has been selected the corrected betas for the
tumour and microenvironment (output$`Corrected_betas`) will be available in
addition to the parameters of the refitted new regressions
(output$`Regression_parameters`).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span></span>
<span><span class="co"># Using the non-refitting approach for all the CpGs</span></span>
<span><span class="fu">reference_based_beta_correction</span><span class="op">(</span>betas_to_correct <span class="op">=</span> <span class="va">example_betas_to_correct</span>,</span>
<span>                                purities_samples_to_correct <span class="op">=</span> <span class="va">purity_estimation_output</span>,</span>
<span>                                only_certain_CpGs <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                                refitting <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                                reference_regressions <span class="op">=</span> <span class="va">reference_regression_generator_output</span>,</span>
<span>                                cores <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Using the non-refitting approach for certain CpGs</span></span>
<span><span class="fu">reference_based_beta_correction</span><span class="op">(</span>betas_to_correct <span class="op">=</span> <span class="va">example_betas_to_correct</span>,</span>
<span>                                purities_samples_to_correct <span class="op">=</span> <span class="va">purity_estimation_output</span>,</span>
<span>                                only_certain_CpGs <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                CpGs_to_correct_vector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cg09248054"</span>, <span class="st">"cg08231710"</span><span class="op">)</span>,</span>
<span>                                refitting <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                                refernce_regressions <span class="op">=</span> <span class="va">reference_regression_generator_output</span>,</span>
<span>                                cores <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Using the refitting approach</span></span>
<span><span class="fu">reference_based_beta_correction</span><span class="op">(</span>betas_to_correct <span class="op">=</span> <span class="va">example_betas_to_correct</span>,</span>
<span>                                purities_samples_to_correct <span class="op">=</span> <span class="va">purity_estimation_output</span>,</span>
<span>                                only_certain_CpGs <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                                refitting <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                reference_betas <span class="op">=</span> <span class="va">example_betas_reference</span>,</span>
<span>                                reference_purities <span class="op">=</span> <span class="va">example_purities_reference</span>,</span>
<span>                                set_seed <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                seed_num <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                                cores <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span></span></code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Iñaki Sasiain Casado.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

