<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Reference regression generator — reference_regression_generator • PureBeta</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Reference regression generator — reference_regression_generator"><meta name="description" content="This function generates the reference regressions' parameters and variance of
the reference CpGs required in subsequent steps of the PureBeta
workflow based on the Staaf &amp;amp; Aine methylation beta value correction strategy.
This function allows multi-core execution."><meta property="og:description" content="This function generates the reference regressions' parameters and variance of
the reference CpGs required in subsequent steps of the PureBeta
workflow based on the Staaf &amp;amp; Aine methylation beta value correction strategy.
This function allows multi-core execution."><meta property="og:image" content="https://staaflab.github.io/PureBeta/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">PureBeta</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Reference regression generator</h1>

      <div class="d-none name"><code>reference_regression_generator.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function generates the reference regressions' parameters and variance of
the reference CpGs required in subsequent steps of the PureBeta
workflow based on the Staaf &amp; Aine methylation beta value correction strategy.
This function allows multi-core execution.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">reference_regression_generator</span><span class="op">(</span></span>
<span>  <span class="va">beta_values</span>,</span>
<span>  <span class="va">tumour_purities</span>,</span>
<span>  set_seed <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  seed_num <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>  cores <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-beta-values">beta_values<a class="anchor" aria-label="anchor" href="#arg-beta-values"></a></dt>
<dd><p>A matrix with CpGs as rows and analysed samples as columns
with the uncorrected beta values from the CpGs of the samples that are
intended to be used to build the reference regressions. The values must be
numeric, the rows must be names with the CpG ID, and the columns with the
sample IDs. An example of the required format is available in the
example_betas_reference matrix.</p></dd>


<dt id="arg-tumour-purities">tumour_purities<a class="anchor" aria-label="anchor" href="#arg-tumour-purities"></a></dt>
<dd><p>Named vector containing the purity values of
of the samples whose DNA methylation beta values are intended to be used to
build the reference regressions. The vector must be named with the sample ID,
which must match with the sample IDs from the matrix containing the beta
values. An example of the required format is available in the
example_purities_reference vector</p></dd>


<dt id="arg-set-seed">set_seed<a class="anchor" aria-label="anchor" href="#arg-set-seed"></a></dt>
<dd><p>Default = FALSE. A seed for the FlexMix package to detect
the different CpG methylation patterns can be used by setting this argument
to TRUE.</p></dd>


<dt id="arg-seed-num">seed_num<a class="anchor" aria-label="anchor" href="#arg-seed-num"></a></dt>
<dd><p>Default = 2000. The seed to be used when set_seed = TRUE can
be specified here.</p></dd>


<dt id="arg-cores">cores<a class="anchor" aria-label="anchor" href="#arg-cores"></a></dt>
<dd><p>Default = 1. Number of cores to be used to run the function in
parallel.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list with the parameters of the computed reference regressions. The
list contains the variance of the betas of CpGs used to build the regressions
(output$cpg.variance), the slopes, intercepts residual standard error and
degrees of freedom of the regression calculated per CpG (output$reg.slopes,
output$reg.intercepts, output$reg.RSE and output$df). Additionally, the list
also includes the original uncorrected beta values (output$betas.original),
the corrected tumour beta values (output$betas.tumour), the corrected microenvironment
beta values (output$betas.microenvironment), the original purity values (output$purities)
the methylation pattern or population assigned to each sample used to buld the reference
regressions per CpG (output$cpg.populations).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span></span>
<span><span class="co"># Using the default parameters</span></span>
<span><span class="fu">reference_regression_generator</span><span class="op">(</span>beta_values <span class="op">=</span> <span class="va">example_betas_reference</span>,</span>
<span>                             tumour_purities <span class="op">=</span> <span class="va">example_purities_reference</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Specifying new parameters</span></span>
<span><span class="fu">reference_regression_generator</span><span class="op">(</span>beta_values <span class="op">=</span> <span class="va">example_betas_reference</span>,</span>
<span>                               tumour_purities <span class="op">=</span> <span class="va">example_purities_reference</span>,</span>
<span>                               set_seed <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                               seed_num <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                               cores <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span></code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Iñaki Sasiain Casado.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

